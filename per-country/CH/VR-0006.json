[
  {
    "Identifier": "VR-CH-0006",
    "Type": "Acceptance",
    "Country": "CH",
    "Version": "1.0.7",
    "SchemaVersion": "1.0.0",
    "Engine": "CERTLOGIC",
    "EngineVersion": "0.7.5",
    "CertificateType": "Vaccination",
    "Description": [
      {
        "desc": "For 2/2 doses, the current date and time must be before the vaccination date plus 365 days for 2-dose vaccines",
        "lang": "en"
      }
    ],
    "ValidFrom": "2021-12-17T00:00:00Z",
    "ValidTo": "2031-01-01T00:00:00Z",
    "AffectedFields": [
      "v.0.mp",
      "v.0",
      "v.0.dt"
    ],
    "Logic": {
      "if": [
        {
          "and": [
            {
              "var": "payload.v.0"
            },
            {
              "in": [
                {
                  "var": "payload.v.0.mp"
                },
                [
                  "EU/1/20/1528",
                  "EU/1/20/1507",
                  "EU/1/21/1529",
                  "CoronaVac",
                  "BBIBP-CorV",
                  "Covishield",
                  "Covaxin",
                  "BBIBP-CorV_T",
                  "CoronaVac_T",
                  "Covaxin_T",
                  "R-COVI",
                  "Covid-19-recombinant"
                ]
              ]
            }
          ]
        },
        {
          "before": [
            {
              "plusTime": [
                {
                  "var": "external.validationClock"
                },
                0,
                "day"
              ]
            },
            {
              "plusTime": [
                {
                  "var": "payload.v.0.dt"
                },
                365,
                "day"
              ]
            }
          ]
        },
        true
      ]
    },
    "expr-as-text": "if (/payload.v.0) and ((/payload.v.0.mp) in ([ \"EU/1/20/1528\", \"EU/1/20/1507\", \"EU/1/21/1529\", \"CoronaVac\", \"BBIBP-CorV\", \"Covishield\", \"Covaxin\", \"BBIBP-CorV_T\", \"CoronaVac_T\", \"Covaxin_T\", \"R-COVI\", \"Covid-19-recombinant\" ])) then (/external.validationClock +0 days) before (/payload.v.0.dt +365 days) else true"
  }
]